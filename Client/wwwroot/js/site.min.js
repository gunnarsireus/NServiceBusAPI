$(document).ready((() => { $("#CarsForCompany").on("change", (() => { window.location = "/Car/index?id=" + $("#CarsForCompany").val() })), document.querySelectorAll('[name="status"]').forEach((e => { e.addEventListener("click", doFiltering) })), timerJob(), console.log("documentReady") })), $(".uppercase").on("keyup", (function () { let e = $(this).val(); $(this).val(e.toUpperCase()) })); const clearErrors = () => { $(".validation-summary-errors").empty(); for (var e = document.getElementsByClassName("text-danger"), t = 0; t < e.length; t++)e[t].innerHTML = "" }, setupClearErrors = () => { clearErrors(); var e = document.getElementById("CreateForm"); e && e.addEventListener("mousedown", clearErrors) }; document.addEventListener("DOMContentLoaded", setupClearErrors); const timerJob = () => { $.ajax({ url: "http://localhost:63567/api/carapi/getallcars", type: "GET", dataType: "json", success: e => { if (0 === e.length) return setTimeout(timerJob, 100), void console.log("Inga bilar hittade!"); let t = e[Math.floor(Math.random() * e.length)]; if (!0 === t.disabled) return void console.log(t.regNr + " is blocked for uppdating of Online/Offline!"); t.online = !t.online, $.ajax({ url: "http://localhost:63567/api/carapi/updateonline", contentType: "application/json", type: "POST", data: JSON.stringify(t), dataType: "json", success: e => { }, error: e => { } }); const n = `#${t.id} td:eq(2)`, a = `#${t.id + "_2"} td:eq(3)`, r = "#" + (t.id + "_3"); !0 === t.online ? ($(n).text("Online"), $(n).removeClass("alert-danger"), $(a).text("Online"), $(a).removeClass("alert-danger"), $(r).text("Online"), $(r).removeClass("alert-danger"), console.log(t.regNr + " is Online!")) : ($(n).text("Offline"), $(n).addClass("alert-danger"), $(a).text("Offline"), $(a).addClass("alert-danger"), $(r).text("Offline"), $(r).addClass("alert-danger"), console.log(t.regNr + " is Offline!")), null !== document.getElementById("All") && doFiltering() } }), setTimeout(timerJob, 500) }, doFiltering = () => { let e = 0, t = document.getElementById("All"); !1 === t.checked && (t = document.getElementById("Online"), e = !0 === t.checked ? 1 : 2); var n = $("#cars > tbody"); $("tr", n).each((function () { $(this).removeClass("hidden"); let t = $("td:eq(2)", $(this)).html(); void 0 !== t && (t = t.trim()), "Offline" === t && 1 === e && $(this).addClass("hidden"), "Online" === t && 2 === e && $(this).addClass("hidden") })) };